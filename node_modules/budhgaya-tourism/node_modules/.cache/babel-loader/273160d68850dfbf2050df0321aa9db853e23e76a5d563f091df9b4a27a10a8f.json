{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import styles from'./Chatbot.module.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Chatbot(){const[messages,setMessages]=useState([]);const[input,setInput]=useState('');const[open,setOpen]=useState(false);const scrollRef=useRef(null);// Client-side posts to server /api/chat which proxies to OpenAI. This keeps the API key secret.\nuseEffect(()=>{if(scrollRef.current)scrollRef.current.scrollTop=scrollRef.current.scrollHeight;},[messages,open]);const handleSend=async()=>{if(!input.trim())return;const userMessage={sender:'user',text:input};setMessages(prev=>[...prev,userMessage]);try{const resp=await fetch('/api/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:input})});const data=await resp.json();if(resp.ok)setMessages(prev=>[...prev,{sender:'bot',text:data.reply}]);else setMessages(prev=>[...prev,{sender:'bot',text:data.error||'Sorry, something went wrong.'}]);}catch(err){setMessages(prev=>[...prev,{sender:'bot',text:'Sorry, I could not process your request right now.'}]);}setInput('');};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{\"aria-label\":\"Help\",className:styles.helpButton,onClick:()=>setOpen(o=>!o),children:\"?\"}),open&&/*#__PURE__*/_jsxs(\"div\",{className:styles.chatbot,role:\"dialog\",\"aria-label\":\"Site chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.chatHeader,children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Help\"}),/*#__PURE__*/_jsx(\"button\",{className:styles.closeBtn,onClick:()=>setOpen(false),\"aria-label\":\"Close\",children:\"\\xD7\"})]}),/*#__PURE__*/_jsx(\"div\",{className:styles.chatWindow,ref:scrollRef,children:messages.map((message,index)=>/*#__PURE__*/_jsx(\"div\",{className:message.sender==='user'?styles.userMessage:styles.botMessage,children:message.text},index))}),/*#__PURE__*/_jsxs(\"div\",{className:styles.inputArea,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:input,onChange:e=>setInput(e.target.value),placeholder:\"Ask about travel, temples, or directions...\",className:styles.input,onKeyDown:e=>{if(e.key==='Enter'){e.preventDefault();handleSend();}}}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSend,className:styles.sendButton,children:\"Send\"})]})]})]});}export default Chatbot;","map":{"version":3,"names":["React","useState","useRef","useEffect","styles","jsx","_jsx","jsxs","_jsxs","Chatbot","messages","setMessages","input","setInput","open","setOpen","scrollRef","current","scrollTop","scrollHeight","handleSend","trim","userMessage","sender","text","prev","resp","fetch","method","headers","body","JSON","stringify","message","data","json","ok","reply","error","err","children","className","helpButton","onClick","o","chatbot","role","chatHeader","closeBtn","chatWindow","ref","map","index","botMessage","inputArea","type","value","onChange","e","target","placeholder","onKeyDown","key","preventDefault","sendButton"],"sources":["C:/Users/admin/workspace/budhgaya.com/client/src/components/Chatbot.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport styles from './Chatbot.module.css';\r\n\r\nfunction Chatbot() {\r\n  const [messages, setMessages] = useState([]);\r\n  const [input, setInput] = useState('');\r\n  const [open, setOpen] = useState(false);\r\n  const scrollRef = useRef(null);\r\n\r\n  // Client-side posts to server /api/chat which proxies to OpenAI. This keeps the API key secret.\r\n\r\n  useEffect(() => {\r\n    if (scrollRef.current) scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\r\n  }, [messages, open]);\r\n\r\n  const handleSend = async () => {\r\n    if (!input.trim()) return;\r\n    const userMessage = { sender: 'user', text: input };\r\n    setMessages(prev => [...prev, userMessage]);\r\n\r\n    try {\r\n      const resp = await fetch('/api/chat', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ message: input })\r\n      });\r\n      const data = await resp.json();\r\n      if (resp.ok) setMessages(prev => [...prev, { sender: 'bot', text: data.reply }]);\r\n      else setMessages(prev => [...prev, { sender: 'bot', text: data.error || 'Sorry, something went wrong.' }]);\r\n    } catch (err) {\r\n      setMessages(prev => [...prev, { sender: 'bot', text: 'Sorry, I could not process your request right now.' }]);\r\n    }\r\n\r\n    setInput('');\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <button\r\n        aria-label=\"Help\"\r\n        className={styles.helpButton}\r\n        onClick={() => setOpen(o => !o)}\r\n      >\r\n        ?\r\n      </button>\r\n\r\n      {open && (\r\n        <div className={styles.chatbot} role=\"dialog\" aria-label=\"Site chat\">\r\n          <div className={styles.chatHeader}>\r\n            <strong>Help</strong>\r\n            <button className={styles.closeBtn} onClick={() => setOpen(false)} aria-label=\"Close\">Ã—</button>\r\n          </div>\r\n          <div className={styles.chatWindow} ref={scrollRef}>\r\n            {messages.map((message, index) => (\r\n              <div key={index} className={message.sender === 'user' ? styles.userMessage : styles.botMessage}>\r\n                {message.text}\r\n              </div>\r\n            ))}\r\n          </div>\r\n          <div className={styles.inputArea}>\r\n            <input\r\n              type=\"text\"\r\n              value={input}\r\n              onChange={(e) => setInput(e.target.value)}\r\n              placeholder=\"Ask about travel, temples, or directions...\"\r\n              className={styles.input}\r\n              onKeyDown={(e) => { if (e.key === 'Enter') { e.preventDefault(); handleSend(); } }}\r\n            />\r\n            <button onClick={handleSend} className={styles.sendButton}>Send</button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chatbot;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}